<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="datasources"></a><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">И</span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">сточники данных</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Источники данных обеспечивают работу связанных с данными (data-aware) компонентов. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Визуальные компоненты сами не обращаются к </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Middleware</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, а получают экземпляры сущностей из связанных источников данных. При этом один источник данных может обслуживать несколько визуальных компонентов, если им нужен один и тот же экземпляр или набор экземпляров. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Связь визуального компонента и источника данных проявляется в следующем: </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При изменении пользователем значения в компоненте новое значение проставляется в атрибуте сущности, находящейся в источнике. </li>
<li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При изменении атрибута сущности из кода новое значение проставляется и отображается в визуальном компоненте. </li>
<li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для слежения за вводом пользователя можно использовать как <a href="https://doc.cuba-platform.com/manual-6.10-ru/datasource_listeners.html"><span style=" text-decoration: underline; color:#0000ff;">слушатель источника данных</span></a>, так и слушатель значения визуального компонента - они срабатывают друг за другом. </li>
<li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При необходимости прочитать или записать значение атрибута сущности в коде предпочтительнее использовать источник данных, а не компонент. Рассмотрим пример чтения атрибута: </li></ul>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">@Inject</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">private FieldGroup fieldGroup;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'monospace'; font-size:9pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">@Inject</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">private Datasource&lt;Order&gt; orderDs;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'monospace'; font-size:9pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">@Named(&quot;fieldGroup.customer&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">private PickerField customerField;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'monospace'; font-size:9pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">public void init(Map&lt;String, Object&gt; params){</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    Customer customer;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    // Get customer from component: not for common use</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    Component component = fieldGroup.getFieldNN(&quot;customer&quot;).getComponentNN();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    customer = ((HasValue)component).getValue();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    // Get customer from component</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    customer = customerField.getValue();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    // Get customer from datasource: recommended</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    customer = orderDs.getItem().getCustomer();</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">} </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Как видно из примера, работа со значениями атрибутов сущностей через компонент - не самый прямолинейный способ. В первом случае он требует приведения типа и указания поля </span><a href="https://doc.cuba-platform.com/manual-6.10-ru/gui_FieldGroup.html"><span style=" font-family:'Sans Serif'; font-size:9pt; text-decoration: underline; color:#0000ff;">FieldGroup</span></a><span style=" font-family:'Sans Serif'; font-size:9pt;"> в виде строки. Второй пример более безопасный и прямой, но он требует знания ещё и типа поля, которое должно быть </span><a href="https://doc.cuba-platform.com/manual-6.10-ru/screen_controller_injection.html"><span style=" font-family:'Sans Serif'; font-size:9pt; text-decoration: underline; color:#0000ff;">инжектировано</span></a><span style=" font-family:'Sans Serif'; font-size:9pt;"> в контроллер. В то же время, получив методом </span><span style=" font-family:'monospace'; font-size:9pt;">getItem()</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> из источника данных хранящийся в нем экземпляр, можно напрямую читать и изменять значения его атрибутов. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Sans Serif'; font-size:9pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Как правило, визуальный компонент привязывается к атрибуту, непосредственно принадлежащему сущности, находящейся в источнике данных. В приведенном выше примере компонент привязан к атрибуту </span><span style=" font-family:'monospace'; font-size:9pt;">customer</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> сущности </span><span style=" font-family:'monospace'; font-size:9pt;">Order</span><span style=" font-family:'Sans Serif'; font-size:9pt;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Можно также привязать компонент к атрибуту связанной сущности, например к </span><span style=" font-family:'monospace'; font-size:9pt;">customer.name</span><span style=" font-family:'Sans Serif'; font-size:9pt;">. В этом случае компонент будет корректно отображать значение атрибута </span><span style=" font-family:'monospace'; font-size:9pt;">name</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, но при его изменении пользователем слушатели источника данных вызваны не будут, и изменения не будут сохранены. Поэтому привязывать компонент к атрибутам второго и более порядка имеет смысл только для отображения, например в </span><a href="https://doc.cuba-platform.com/manual-6.10-ru/gui_Label.html"><span style=" font-family:'Sans Serif'; font-size:9pt; text-decoration: underline; color:#0000ff;">Label</span></a><span style=" font-family:'Sans Serif'; font-size:9pt;">, колонке </span><a href="https://doc.cuba-platform.com/manual-6.10-ru/gui_Table.html"><span style=" font-family:'Sans Serif'; font-size:9pt; text-decoration: underline; color:#0000ff;">Table</span></a><span style=" font-family:'Sans Serif'; font-size:9pt;"> или установив для </span><a href="https://doc.cuba-platform.com/manual-6.10-ru/gui_TextField.html"><span style=" font-family:'Sans Serif'; font-size:9pt; text-decoration: underline; color:#0000ff;">TextField</span></a><span style=" font-family:'Sans Serif'; font-size:9pt;"> свойство </span><span style=" font-family:'monospace'; font-size:9pt;">editable = false</span><span style=" font-family:'Sans Serif'; font-size:9pt;">. </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Источники данных также отслеживают изменения содержащихся в них сущностей, и могут отправлять измененные экземпляры обратно на </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Middleware</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> для сохранения в базе данных. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Рассмотрим основные интерфейсы источников. </span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1580345236dxgq16xp6z.png" /><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Рисунок 22. Интерфейсы источников данных </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://files.cuba-platform.com/javadoc/cuba/6.10/com/haulmont/cuba/gui/data/Datasource.html"><span style=" text-decoration: underline; color:#0000ff;">Datasource</span></a> − простейший источник данных, предназначенный для работы с одним экземпляром сущности. Экземпляр устанавливается методом <span style=" font-family:'monospace';">setItem()</span> и доступен через <span style=" font-family:'monospace';">getItem()</span>. </li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Стандартной реализацией такого источника является класс </span><span style=" font-family:'monospace'; font-size:9pt;">DatasourceImpl</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, который используется, например, как главный источник данных в </span><a href="https://doc.cuba-platform.com/manual-6.10-ru/screen_edit.html"><span style=" font-family:'Sans Serif'; font-size:9pt; text-decoration: underline; color:#0000ff;">экранах редактирования</span></a><span style=" font-family:'Sans Serif'; font-size:9pt;"> сущностей. </span></p>
<li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://files.cuba-platform.com/javadoc/cuba/6.10/com/haulmont/cuba/gui/data/CollectionDatasource.html"><span style=" text-decoration: underline; color:#0000ff;">CollectionDatasource</span></a> − источник данных, предназначенный для работы с коллекцией экземпляров сущности. Коллекция загружается при вызове метода <span style=" font-family:'monospace';">refresh()</span>, ключи экземпляров доступны через метод <span style=" font-family:'monospace';">getItemIds()</span>. Метод <span style=" font-family:'monospace';">setItem()</span> устанавливает, а <span style=" font-family:'monospace';">getItem()</span> возвращает &quot;текущий&quot; экземпляр коллекции, т.е., например, соответствующий выбранной в данный момент строке таблицы. </li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Способ загрузки коллекции сущностей определяется реализацией. Наиболее типичный - загрузка с Middleware через </span><a href="https://doc.cuba-platform.com/manual-6.10-ru/dataManager.html"><span style=" font-family:'Sans Serif'; font-size:9pt; text-decoration: underline; color:#0000ff;">DataManager</span></a><span style=" font-family:'Sans Serif'; font-size:9pt;">, при этом для формирования JPQL запроса используются методы </span><span style=" font-family:'monospace'; font-size:9pt;">setQuery()</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, </span><span style=" font-family:'monospace'; font-size:9pt;">setQueryFilter()</span><span style=" font-family:'Sans Serif'; font-size:9pt;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Стандартной реализацией такого источника является класс </span><span style=" font-family:'monospace'; font-size:9pt;">CollectionDatasourceImpl</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, который используется в экранах, отображающих списки сущностей. </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://files.cuba-platform.com/javadoc/cuba/6.10/com/haulmont/cuba/gui/data/GroupDatasource.html"><span style=" text-decoration: underline; color:#0000ff;">GroupDatasource</span></a> − подвид <span style=" font-family:'monospace';">CollectionDatasource</span>, предназначенный для работы с компонентом <a href="https://doc.cuba-platform.com/manual-6.10-ru/gui_GroupTable.html"><span style=" text-decoration: underline; color:#0000ff;">GroupTable</span></a>. </li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:2; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Стандартной реализацией является класс </span><span style=" font-family:'monospace'; font-size:9pt;">GroupDatasourceImpl</span><span style=" font-family:'Sans Serif'; font-size:9pt;">. </span></p>
<li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://files.cuba-platform.com/javadoc/cuba/6.10/com/haulmont/cuba/gui/data/HierarchicalDatasource.html"><span style=" text-decoration: underline; color:#0000ff;">HierarchicalDatasource</span></a> − подвид <span style=" font-family:'monospace';">CollectionDatasource</span>, предназначенный для работы с компонентами <a href="https://doc.cuba-platform.com/manual-6.10-ru/gui_Tree.html"><span style=" text-decoration: underline; color:#0000ff;">Tree</span></a> и <a href="https://doc.cuba-platform.com/manual-6.10-ru/gui_TreeTable.html"><span style=" text-decoration: underline; color:#0000ff;">TreeTable</span></a>. </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:2; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Стандартной реализацией является класс </span><span style=" font-family:'monospace'; font-size:9pt;">HierarchicalDatasourceImpl</span><span style=" font-family:'Sans Serif'; font-size:9pt;">. </span></p>
<li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://files.cuba-platform.com/javadoc/cuba/6.10/com/haulmont/cuba/gui/data/NestedDatasource.html"><span style=" text-decoration: underline; color:#0000ff;">NestedDatasource</span></a> - источник данных, предназначенный для работы с экземплярами, загруженными в атрибуте другой сущности. При этом источник, содержащий сущность-хозяина, доступен методом <span style=" font-family:'monospace';">getMaster()</span>, а <a href="https://doc.cuba-platform.com/manual-6.10-ru/metadata_interfaces.html#metaProperty"><span style=" text-decoration: underline; color:#0000ff;">мета-свойство</span></a>, соответствующее атрибуту хозяина, содержащему экземпляры данного источника, доступно через метод <span style=" font-family:'monospace';">getProperty()</span>. </li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Например, в источнике </span><span style=" font-family:'monospace'; font-size:9pt;">dsOrder</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> установлен экземпляр сущности </span><span style=" font-family:'monospace'; font-size:9pt;">Order</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, содержащий ссылку на экземпляр </span><span style=" font-family:'monospace'; font-size:9pt;">Customer</span><span style=" font-family:'Sans Serif'; font-size:9pt;">. Тогда для связи экземпляра </span><span style=" font-family:'monospace'; font-size:9pt;">Customer</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> с визуальными компонентами достаточно создать </span><span style=" font-family:'monospace'; font-size:9pt;">NestedDatasource</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, у которого хозяином является </span><span style=" font-family:'monospace'; font-size:9pt;">dsOrder</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, а мета-свойство указывает на атрибут </span><span style=" font-family:'monospace'; font-size:9pt;">Order.customer</span><span style=" font-family:'Sans Serif'; font-size:9pt;">. </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://files.cuba-platform.com/javadoc/cuba/6.10/com/haulmont/cuba/gui/data/PropertyDatasource.html"><span style=" text-decoration: underline; color:#0000ff;">PropertyDatasource</span></a> - подвид <span style=" font-family:'monospace';">NestedDatasource</span>, предназначенный для работы с одним экземпляром или коллекцией связанных сущностей, не являющихся встроенными (embedded). </li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:2; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Стандартные реализации: для работы с одним экземпляром - </span><span style=" font-family:'monospace'; font-size:9pt;">PropertyDatasourceImpl</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, для работы с коллекцией - </span><span style=" font-family:'monospace'; font-size:9pt;">CollectionPropertyDatasourceImpl</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, </span><span style=" font-family:'monospace'; font-size:9pt;">GroupPropertyDatasourceImpl</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, </span><span style=" font-family:'monospace'; font-size:9pt;">HierarchicalPropertyDatasourceImpl</span><span style=" font-family:'Sans Serif'; font-size:9pt;">. Последние реализуют также интерфейс </span><span style=" font-family:'monospace'; font-size:9pt;">CollectionDatasource</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, однако некоторые его нерелевантные методы, связанные с загрузкой, например, </span><span style=" font-family:'monospace'; font-size:9pt;">setQuery()</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, выбрасывают </span><span style=" font-family:'monospace'; font-size:9pt;">UnsupportedOperationException</span><span style=" font-family:'Sans Serif'; font-size:9pt;">. </span></p>
<li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://files.cuba-platform.com/javadoc/cuba/6.10/com/haulmont/cuba/gui/data/EmbeddedDatasource.html"><span style=" text-decoration: underline; color:#0000ff;">EmbeddedDatasource</span></a> - подвид <span style=" font-family:'monospace';">NestedDatasource</span>, содержащий экземпляр встроенной сущности. </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:2; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Стандартной реализацией является класс </span><span style=" font-family:'monospace'; font-size:9pt;">EmbeddedDatasourceImpl</span><span style=" font-family:'Sans Serif'; font-size:9pt;">. </span></p>
<li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://files.cuba-platform.com/javadoc/cuba/6.10/com/haulmont/cuba/gui/data/RuntimePropsDatasource.html"><span style=" text-decoration: underline; color:#0000ff;">RuntimePropsDatasource</span></a> − специфический источник, предназначенный для работы с <a href="https://doc.cuba-platform.com/manual-6.10-ru/dynamic_attributes.html"><span style=" text-decoration: underline; color:#0000ff;">динамическими атрибутами</span></a> сущностей. </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Как правило, источники данных объявляются декларативно в секции </span><span style=" font-family:'monospace'; font-size:9pt;">dsContext</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><a href="https://doc.cuba-platform.com/manual-6.10-ru/screen_xml.html"><span style=" font-family:'Sans Serif'; font-size:9pt; text-decoration: underline; color:#0000ff;">дескриптора экрана</span></a><span style=" font-family:'Sans Serif'; font-size:9pt;">. </span></p>
<p style=" margin-top:8px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="datasource_auto_refresh"></a><span style=" font-family:'Sans Serif'; font-size:9pt;">А</span><span style=" font-family:'Sans Serif'; font-size:9pt;">втоматическое обновление CollectionDatasource </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">При открытии экрана, его визуальные компоненты, соединенные с источниками типа </span><span style=" font-family:'monospace'; font-size:9pt;">CollectionDatasource</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, заставляют эти источники загрузить данные. В результате, </span><a href="https://doc.cuba-platform.com/manual-6.10-ru/gui_Table.html"><span style=" font-family:'Sans Serif'; font-size:9pt; text-decoration: underline; color:#0000ff;">таблицы</span></a><span style=" font-family:'Sans Serif'; font-size:9pt;"> отображают данные сразу после открытия экрана, без всякого дополнительного действия пользователя. Если вы хотите предотвратить автоматическую загрузку, то установите параметр экрана </span><span style=" font-family:'monospace'; font-size:9pt;">DISABLE_AUTO_REFRESH</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> в </span><span style=" font-family:'monospace'; font-size:9pt;">true</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> в методе </span><span style=" font-family:'monospace'; font-size:9pt;">init()</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> этого экрана, или передайте его из вызывающего кода. Данный параметр определен в перечислении </span><span style=" font-family:'monospace'; font-size:9pt;">WindowParams</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, поэтому он может быть задан следующим образом: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">@Override</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">public void init(Map&lt;String, Object&gt; params) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    WindowParams.DISABLE_AUTO_REFRESH.set(params, true);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">} </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">В этом случае, источники данных типа </span><span style=" font-family:'monospace'; font-size:9pt;">CollectionDatasource</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> будут загружены только когда будет вызван их метод </span><span style=" font-family:'monospace'; font-size:9pt;">refresh()</span><span style=" font-family:'Sans Serif'; font-size:9pt;">. Это может быть сделано как кодом приложения, так и в случае, если пользователь нажмет кнопку </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Search</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> компонента </span><a href="https://doc.cuba-platform.com/manual-6.10-ru/gui_Filter.html"><span style=" font-family:'Sans Serif'; font-size:9pt; text-decoration: underline; color:#0000ff;">Filter</span></a><span style=" font-family:'Sans Serif'; font-size:9pt;">. </span></p></body></html>