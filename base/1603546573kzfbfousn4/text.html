<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#282c34;"><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.groupstp.rtneo.core.bean.tools.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DatePeriodTools<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.groupstp.rtneo.entity.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.groupstp.rtneo.entity.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.groupstp.rtneo.entity.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContractPosition<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.groupstp.rtneo.entity.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.groupstp.rtneo.entity.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentRealEstate<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.groupstp.rtneo.entity.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Payment<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.app.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">FileStorageAPI<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.entity.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">FileDescriptor<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.entity.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">KeyValueEntity<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.global.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.global.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DataManager<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.global.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">FluentLoader<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.global.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">UuidProvider<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.global.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ViewRepository</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.global.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">View<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.opencsv.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CSVReader<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">org.slf4j.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Logger</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">org.slf4j.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">LoggerFactory</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">de.diedavids.cuba.runtimediagnose.groovy.*<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">groovy.transform.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#e5c07b;">InheritConstructors</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.text.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.util.function.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BiPredicate<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.util.function.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Predicate<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.util.stream.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Collectors</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">long </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">st = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">System</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">currentTimeMillis</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br /><br />dataManager = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DataManager</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//dateView = new SimpleDateFormat(&quot;dd-MM-yyyy&quot;)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">dateView = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;yyyy-MM-dd&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />datePeriodTools = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DatePeriodTools</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">reportStart = dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;2020-07-01&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">reportStop = to = dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;2020-09-30&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">paymentLimitDate = dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'2020-10-23'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />contractLimit = dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;2020-12-31&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">from = dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;2019-01-01&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">to = dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;2020-12-31&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br />tariffs = dataManager.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">loadValues</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select t.tariff*1.2, t.dateSince, t.dateTill from rtneo$Tariff t where t.name = 1'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">properties</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;tariff&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;from&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;to&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">list</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Коллекция исключенных объектов<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Map</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; excluded = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">long </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">pr = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">System</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">currentTimeMillis</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;Pre start </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">pr-st</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//ContragentsSupplier supplier = new ContragentById(log)<br />//supplier.setContragent_id('fabf3200-0a3f-3185-31c3-5137da056284')<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentsSupplier </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">supplier = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentsNoFact</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(log)<br />supplier.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setFirstResult</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />supplier.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setMaxResults</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">100</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />supplier.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setFilter</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//supplier.setPredicates(getPredicators())<br />//FileDescriptor excludeFile = dataManager.load(FileDescriptor.class)<br />//        .id(UuidProvider.fromString('308e6069-5d3a-aee2-01b5-e3d6761ce573'))<br />//        .view(View.MINIMAL)<br />//        .optional().orElse(null);<br />//supplier.setExcludeFileId(excludeFile)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; contragents = supplier.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getContragents</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">long </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">ft = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">System</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">currentTimeMillis</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;Get contragents </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">ft-pr</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">TreeMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; contragentsGroup = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getContragentsGroup</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contragents, paymentLimitDate, from, to)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">long </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">pa = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">System</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">currentTimeMillis</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;Payments &amp; Accruals </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">pa-ft</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Форматируем данные для вывода<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; res = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getFormatData</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contragentsGroup)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">long </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">mr = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">System</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">currentTimeMillis</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;More </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">mr-pa</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">printUPD</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(from, res, excluded, contractLimit, reportStart, reportStop)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">printSummary</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(res, excluded)<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">private void </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">printUPD</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">from</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">res</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">excluded</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contractLimit</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">reportStart</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">reportStop</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">endMonth = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getInstance</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br />    endMonth.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setTime</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">from</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; totalsNullAccrualContract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ArrayList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt;&gt; zeroMap = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; zeroList = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ArrayList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; excledeOutList = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ArrayList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;!Наименование услуги!Дата договора!Основной договор!Номер УПД!Дата УПД!Дата корр.!ИНН!КПП!ЛС!Объем!Цена без НДС!Сумма без НДС!НДС!Цена с НДС!Оплачен период!Остаток на начало периода&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemRes </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">res</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">excluded</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">keySet</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">stream</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">anyMatch </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{ </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemRes</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]) </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">continue<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; contractList = dataManager.load(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .query(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select c from rtneo$Contract c where c.contragent.id = :contragent and c.accepted is not null and c.accepted = true and not (c.createTs &gt; :contractLimit and c.createdBy = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">a.kotvinskiy@groupstp.ru</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">) order by c.createTs'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragent&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemRes</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'id'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">])<br />                .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contractLimit&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contractLimit</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .view(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contract-browse&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .list()<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">keyOutput = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />        def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">excledeOut = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; excludeMap = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemRes</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'accruals'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]) {<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">total = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue().getValue()<br /><br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Если период начислени я меньше даты начала, пропускаем<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(dateView.parse(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getKey()).compareTo(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">reportStart</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) &lt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">continue<br />            if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(dateView.parse(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getKey()).compareTo(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">reportStop</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) &gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">continue<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Выводим один не оплаченный месяц<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'done'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] != </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&amp;&amp; !keyOutput) {<br />                keyOutput = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">} </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'done'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] != </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&amp;&amp; keyOutput) {<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">continue<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /><br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Условие чтобы, за 2020 год не выводилоась запись, если оплаты кончились раньше. Переделать<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">from </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">!= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">reportStart</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(dateView.parse(total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">].</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toString</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()).compareTo(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">reportStart</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) == </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0 </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&amp;&amp; total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'residue'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] &lt;= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0 </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&amp;&amp; !total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'residue'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]) excledeOut = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /><br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Дата текстом и числом для вывода<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">endMonth.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setTime</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(dateView.parse(total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">].</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toString</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()));<br />            endMonth.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">set</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">DAY_OF_MONTH</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, endMonth.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getActualMaximum</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">DAY_OF_MONTH</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">month = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTextPeriod</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(dateView.parse(total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]))<br /><br /><br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(excledeOut) {<br />                excludeMap.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;inn&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemRes</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">])<br />                excludeMap.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;kpp&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemRes</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'kpp'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">])<br />            } </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />                log.debug(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;!Услуга Регионального оператора по обращению с ТКО за </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">month</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!!!!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">dateView.format(endMonth.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTime</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemRes</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemRes</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'kpp'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemRes</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'pa'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!!!!!!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'done'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] == </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">? </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'да' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'нет'</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'residue'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            }<br /><br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; itemsList = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getFormatFields</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contractList, total, endMonth)<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">isEmpty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()) {<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Вынести сообщения<br />//            _(&quot;${itemRes.getValue()['id']} itemList empty&quot;)<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">continue<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Порядок вывода реализации и исправления<br />            //реализация<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">print1Contract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Исправление<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">print2Contract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(print1Contract, print2Contract) = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setRuleOutAccrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(itemsList)<br /><br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(excledeOut) {<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(print1Contract) {<br />                    excludeMap.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;number&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;number&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />                    excledeOutList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">add</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(excludeMap)<br />                }<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(print2Contract) {<br />                    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">excludeMapC = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;(excludeMap)<br />                    excludeMapC.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;number&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() - </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;number&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />                    excledeOutList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">add</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(excludeMapC)<br />                }<br />            } </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(print1Contract) </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">printItemFromResultMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(print2Contract) </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">printItemFromResultMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() - </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />            }<br />        }<br />    }<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//    excledeOutList.each{<br />//        if(it instanceof HashMap){<br />//            _(&quot;|${it.get('inn')}|${it.get('kpp')}|${it.get('number')}&quot;)<br />//        }else{<br />//            _(it)<br />//        }<br />//    }<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">private void </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">printSummary</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">LinkedHashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">res</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">excluded</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;|Наименование|ЛС|ИНН|КПП|Объем|Сумма всего|Сумма 2019|Сумма 2020|Остаток|Последний оплаченный период&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">res</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">rAmount = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ZERO<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">rTotalSum = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ZERO<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">payTotalSum = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ZERO<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">period<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">lastPeriod = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />        def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">isHide = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br /><br /><br />        def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">totalSum19 = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ZERO<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">totalSum20 = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ZERO<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; mapResults = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'accruals'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]) {<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//        _(accrual)<br /><br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(lastPeriod) </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">continue<br /><br />            if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue().getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'done'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]) lastPeriod = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br /><br />            if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(!lastPeriod) {<br />                period = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue().getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]<br />                payTotalSum += </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue().getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]<br />            }<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">currPeriod = dateView.parse(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue().getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">])<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(currPeriod.compareTo(dateView.parse(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'2020-01-01'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)) &lt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />                totalSum19 += </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue().getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]<br />            } </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />                totalSum20 += </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue().getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]<br />            }<br /><br /><br />            rAmount += </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue().getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'amountBase'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]<br />            rTotalSum += </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue().getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]<br /><br />        }<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//    if(totalSum20 == 0)isHide = true<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">rTotalSum = rTotalSum.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setScale</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">2</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ROUND_HALF_DOWN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;name&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'name'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">])<br />        mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;pa&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'pa'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">])<br />        mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;inn&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">])<br />        mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;kpp&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'kpp'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">])<br />        mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;amount&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, rAmount.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setScale</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">5</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ROUND_HALF_DOWN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />        mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;totalSum&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, rTotalSum.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setScale</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">2</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ROUND_HALF_DOWN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />        mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;totalSum19&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, totalSum19.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setScale</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">2</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ROUND_HALF_DOWN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />        mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;totalSum20&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, totalSum20.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setScale</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">2</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ROUND_HALF_DOWN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />        mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;payments&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, (</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'sumPayments'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">as </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setScale</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">2</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ROUND_HALF_DOWN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//    def balance = item.getValue()['sumPayments'].compareTo(rTotalSum) &lt; 0 ? item.getValue()['sumPayments'] : item.getValue()['sumPayments'] - rTotalSum<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">balance = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'sumPayments'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] - payTotalSum<br />        mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;balance&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, balance.setScale(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">2</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ROUND_HALF_DOWN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br /><br />        mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;period&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, period)<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//    _(mapResults)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">excluded</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">keySet</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">stream</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">anyMatch </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{ </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]) </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">continue<br />        if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(!isHide) </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">printItemFromResultMapMin</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(mapResults)<br />    }<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'****************************************************************************'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//HashSet(totalsNullAccrualContract).each{_(it)}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return true</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">void </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">printItemFromResultMapMin</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;|</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'name'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">|</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'pa'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">|</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">|</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'kpp'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">|</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'amount'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">|</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">|</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum19'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">|</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum20'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">|</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'balance'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">|</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">replaceAll</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\\</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">p{Cntrl}&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />}<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">abstract class </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentsSupplier</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DataManager </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">dataManager </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DataManager</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Predicate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt;&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">predicates </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ArrayList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;();<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">filter </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">FileDescriptor </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">excludeFileId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">GroovyConsoleLogger </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">ContragentsSupplier</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(){<br /><br />    }<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">ContragentsSupplier</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">GroovyConsoleLogger </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">this</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">log<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">abstract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">contragentsLoad</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getContragents</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; contragents;<br />        contragents = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">contragentsLoad</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">this</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">predicates </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPredicators</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contragents)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">filter</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />            contragents = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">filterContragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contragents)<br />        }<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">excludeFileId </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">!= </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />            contragents = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">excludeFromFile</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />        }<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">contragents;<br />    }<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">View </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">createView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ViewRepository </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">vRep = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ViewRepository</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">vRep.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_minimal&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;inn&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;kpp&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;name&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;personalAccount&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    }<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">filterContragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragents</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragents</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">stream</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">filter</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">c </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">predicates</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">stream</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">map</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">p</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">p </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">as </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Predicate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt;</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">allMatch</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">p </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">p</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">test</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">c</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}}<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">collect</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Collectors</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//            .filter{allPredicates.stream().reduce{a,b -&gt; a.and(b)}.get()}<br />//            .filter{e -&gt; allPredicates.inject(true, {a,b -&gt; it.and})}<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">excludeFromFile</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragents</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; exclude = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">inToFile</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">excludeFileId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragents</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">stream</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">filter</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">!exclude.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">contains</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getInn</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">collect</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />    }<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">inToFile</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">FileDescriptor </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">fd</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">fd </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">== </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">throw new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">RuntimeException</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;fileNotFound&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">FileStorageAPI </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">fileStorageAPI=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">FileStorageAPI</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">InputStream </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">inputStream=fileStorageAPI.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">openStream</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">fd</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CSVReader </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">reader = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CSVReader</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">InputStreamReader</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(inputStream, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;UTF-8&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">));<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">reader.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">readAll</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">stream</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">map</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">collect</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Collectors</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />    }<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Predicate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt;&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPredicators</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragents</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Predicate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt;&gt; allPredicates = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ArrayList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br />        allPredicates.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">add</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">c</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt;<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragents</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">stream</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">filter</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getInn</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() == </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">c</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getInn</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">count</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() == </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return true<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">debug</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;Is filial </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">c</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getInn</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return false<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">allPredicates<br />    }<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#e5c07b;">@InheritConstructors<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentsNoFact </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">extends </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentsSupplier</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">firstResult </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">maxResults </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#e5c07b;">@Override<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">contragentsLoad</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">query = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select distinct c ' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'from rtneo$Payment e ' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'    join rtneo$Contragent c on e.inn = c.inn ' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'    where not e.inn is null and not c.type = 4 ' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'order by c.inn ' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'except ' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select distinct ct.contragent ' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'from rtneo$Contragent c ' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'    join rtneo$Contract ct on c.id = ct.contragent.id ' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'where ' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'    ct.isFactCalculation = true and ct.accepted = true ' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'order by c.inn'<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">FluentLoader</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ByQuery </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">load = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">dataManager</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">load</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">query</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(query)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">view</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">createView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">firstResult </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">!= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)load.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">firstResult</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">firstResult</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">maxResults </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">!= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)load.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">maxResults</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">maxResults</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">load.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">list</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />    }<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#e5c07b;">@InheritConstructors<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentsImplOld </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">extends </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentsSupplier</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#e5c07b;">@Override<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">contragentsLoad</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">oldQuery = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select ' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'distinct c.id, c.inn, c.kpp, c.personalAccount, (select count(ct) from rtneo$Contract ct where ct.contragent.id = c.id and ct.accepted = true and ct.isFactCalculation = true) ' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'from rtneo$Payment e join rtneo$Contragent c on e.inn = c.inn ' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'where not e.inn is null and e.createTs &lt;= :paymentLimitDate order by c.inn'<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; contragents = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">dataManager</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">load</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">query</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(query)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//    .parameter(&quot;paymentLimitDate&quot;, paymentLimitDate)<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">firstResult</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">maxResults</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">10</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">view</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">createView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">list</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">contragents<br />    }<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#e5c07b;">@InheritConstructors<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentById </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">extends </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentsSupplier</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contragent_id</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#e5c07b;">@Override<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">contragentsLoad</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() {<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">query = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select c from rtneo$Contragent c where c.id = :contragent_id'<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; contragents = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">dataManager</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">load</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">query</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(query)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parameter</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragent_id&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">UUID</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">fromString</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contragent_id</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">view</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">createView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">list</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">contragents<br />    }<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setRuleOutAccrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemsList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//реализация<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">print1Contract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Исправление<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">print2Contract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />    if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemsList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()&gt;=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//mapResults.put(&quot;cdate&quot;, contract.getMainContract() == null ? dateView.format(contract.getDate()) : '')<br />        //Если это доп и он один, или это основной договор, выводим<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemsList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'cdate'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">''</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemsList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() == </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)print1Contract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />            print1Contract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemsList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()&gt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Если начисление не по допу, и дата контракта меньше 20-го, реализацию по нему не выводим<br />            //Только 20го года Сделать условие!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemsList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'cdate'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">''</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) &amp;&amp; dateView.parse(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemsList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'cdate'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)).compareTo(dateView.parse(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'01-01-2020'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)) &lt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)print1Contract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Если первое начисление не по допу и последнее не по допу, скрываем реализацию?? Странное условие<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemsList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'cdate'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">''</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) &amp;&amp; !</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemsList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemsList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()-</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'cdate'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">''</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />                print1Contract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//                if(itemsList.get(0).get('cdate').equals('') &amp;&amp; itemsList.get(itemsList.size()-1).get('cdate').equals(''))itemsList.get(itemsList.size()-1)['dateCor'] = ''<br />            //Если сумма реализации(первое начисление) совпадает с исправлением, реализацию не выводим<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemsList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemsList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemsList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()-</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)))print1Contract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Исправление выводим всегда<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">print2Contract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">[print1Contract, print2Contract]<br />    }<br />}<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">private </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getFormatFields</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contractList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">total</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">endMonth</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; itemsList = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ArrayList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contractList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">KeyValueEntity </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">totalAccrualContract = dataManager.loadValues(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select a.documentNumber, max(a.period), sum(a.amountBase), sum(a.amountBase)*max(a.price), max(a.price), sum(a.ndsSum), sum(a.totalSum), sum(a.totalSumBase) from rtneo$Accrual a where a.contractPosition.contract.id = :contract and a.period = :period group by a.documentNumber'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .properties(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;number&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;period&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;amount&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;totalSumWithNDS&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;price&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;totalNDS&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;totalSum&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;totalSumBase&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contract&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />                .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;period&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, dateView.parse(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">total</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]))<br />                .optional()<br />                .orElse(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//            if(totalAccrualContract == null){<br />//                totalsNullAccrualContract.add(itemRes.getValue()['inn'])<br />//                continue<br />//            }<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">mainContractNumber = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getMainContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() != </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">? </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getMainContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNumber</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() : </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">''<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; mapResults = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(totalAccrualContract == </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//                _(&quot;!${contract.getNumber()}!No accruals in to period&quot;)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">} </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />            mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cnumber&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNumber</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />            mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cdate&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getMainContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() == </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">? dateView.format(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getDate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()) : </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">''</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cmnumber&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, mainContractNumber)<br />            mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;number&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'number'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />            mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;period&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, dateView.format(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">endMonth</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTime</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()))<br />            mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;dateCor&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getMainContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() != </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">? dateView.format(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getDate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()) : </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">''</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;amount&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'amount'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />            mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;price&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'price'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) * </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">5 </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">/ </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">6</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">totalNDS = totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalNDS'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) == </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">? </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ZERO </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalNDS'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;totalSumNoNDS&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) - totalNDS)<br />            mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;totalNDS&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, totalNDS)<br />            mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;totalSum&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br /><br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(!(totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).compareTo(totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSumBase'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)) == </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)) {<br />                mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'amount'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) / totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'price'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />            }<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//                accrualsGroup.each{<br />//                    if(!(it.getValue()['totalSum'].compareTo(it.getValue()['totalSumBase']) == 0)){<br />//                        BigDecimal noNdsSum = it.getValue()['totalSum']/(100+it.getValue()['nds'])*100<br />//                        it.getValue().put('amountBase', noNdsSum/it.getValue()['tariff'])<br />//            //            excluded.putIfAbsent(contragent.getValue('inn'), &quot;discount&quot;)<br />//                    }<br />//                }<br /><br /><br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">add</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(mapResults)<br />        }<br /><br />    }<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">itemsList<br />}<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">void </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">printItemFromResultMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'cnumber'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'cdate'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'cmnumber'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'number'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'dateCor'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!!!!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'amount'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'price'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSumNoNDS'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalNDS'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTextPeriod</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">result=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">''<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">!= </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">monthesRP = [</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'январь'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'февраль'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'март'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'апрель'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'май'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'июнь'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'июль'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'август'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'сентябрь'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'октябрь'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'ноябрь'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'декабрь'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">cal = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getInstance</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />        cal.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setTime</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />        result+=monthesRP[cal.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">MONTH</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)]<br />        result+=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot; &quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+cal.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">YEAR</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toString</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()+</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot; г.&quot;<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">result<br />}<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getFormatData</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">TreeMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragentsGroup</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; res = [:]<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contr </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragentsGroup</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">sumPay = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">residue = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0<br />        contr</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'payments'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">].</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">each</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">p </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">sumPay += </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">p</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'sum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">res[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contr</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]] = [<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'id'  </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contr</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'id'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">],<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contr</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">],<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'kpp' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contr</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'kpp'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">],<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'name' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contr</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'name'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">],<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'pa' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contr</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'pa'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">],<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'sumPayments' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: sumPay,<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'accruals'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: [:]<br />        ]<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//    def accrual = []<br />        //Проставляем признак оплаты за период<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrualFor </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contr</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'accruals'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]){<br /><br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(sumPay &gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrualFor</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]){<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrualFor</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'done'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrualFor</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'done'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(sumPay &gt;= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />                residue = sumPay<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrualFor</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'residue'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] = residue<br />            }<br />            sumPay -= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrualFor</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]<br /><br />            res[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contr</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'accruals'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrualFor</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]]=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrualFor<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /><br />    }<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">res<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">private </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">TreeMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getContragentsGroup</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragents</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">paymentLimitDate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">from</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">to</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">TreeMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; contragentsGroup = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">TreeMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;();<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragents</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br /><br />        contragentsGroup.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">putIfAbsent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">inn</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, [<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'id'      </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">id</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'     </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">inn</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'kpp'     </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">kpp</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'name'     </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">name</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'pa'      </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">personalAccount</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'payments'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: [:],<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'accruals'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: [:]<br />        ])<br />        contragentsGroup[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">inn</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'payments'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPayments</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">paymentLimitDate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        contragentsGroup[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">inn</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'accruals'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getAccruals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">from</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">to</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br />        contragentsGroup[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">inn</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'accruals'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">].</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">each </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(!(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">].compareTo(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSumBase'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]) == </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)) {<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">noNdsSum = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] / (</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">100 </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+ </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'nds'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]) * </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">100<br />                it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue().put(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'amountBase'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, noNdsSum / </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'tariff'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">])<br />            }<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">contragentsGroup<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPayments</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">paymentLimitDate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; paymentsMap = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Payment</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; payments = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPaymentsContragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">paymentLimitDate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">payment </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: payments){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">period = dateView.format(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">payment</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getDate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(paymentsMap.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(period) == </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />            paymentsMap[period] = [</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'purpose' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">payment</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">purpose</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'sum' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">payment</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">sum</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]<br />        }</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />            paymentsMap[period][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'sum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] += </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">payment</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getSum</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />        }<br />    }<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">paymentsMap<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getAccruals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">dateFrom</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">dateTo</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">from = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">dateFrom</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toCalendar</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">to = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">dateTo</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toCalendar</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; accrualsGroup = [:]<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">while</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(!from.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">after</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(to)){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; accruals = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getBillsOnPeriod</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">UUID</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">fromString</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">id</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toString</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()), from.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTime</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">roundingTarif = tariffs.stream()<br />                .filter</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">datePeriodTools.isPeriodIncluded(from.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTime</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(), </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'from'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">), </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'to'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.map</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'tariff'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">as </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.map</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.setScale(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">5</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ROUND_HALF_UP</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.findFirst().orElse(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ZERO</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: accruals){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getComment</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;По факту&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />                factAccrual = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />                continue<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPrice</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() == </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />                log.debug(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">id</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;"> accrual.getPrice() is null !!!&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">continue<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">tariffNoNDS = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">NDStools</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getSumWithoutNDS</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPrice</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">period = dateView.format(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPeriod</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(accrualsGroup[period]==</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />                accrualsGroup[period] = [<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'period' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: dateView.format(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPeriod</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()),<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'number' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getDocumentNumber</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(),<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'tariff' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: tariffNoNDS,<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'amountBase' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getAmountBase</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()),<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSumBaseNoNds' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getAmountBase</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())*tariffNoNDS,<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSumBase' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTotalSumBase</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()),<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTotalSum</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()),<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'nds' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNds</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()),<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'residue' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'done' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]<br />            }</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />                accrualsGroup[period][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'amountBase'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] += </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getAmountBase</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />                accrualsGroup[period][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSumBaseNoNds'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] += </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getAmountBase</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())*tariffNoNDS<br />                accrualsGroup[period][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSumBase'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] += </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTotalSumBase</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />                accrualsGroup[period][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] += </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTotalSum</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />            }<br />        }<br />        from.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">add</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">MONTH</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    }<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">accrualsGroup<br />}<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">NDStools</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">static </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setNDS</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">sum</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">sum<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">static </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNDS</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">sum</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">sum<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">static </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getSumWithoutNDS</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">sum</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">sum</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">*</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">5</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">/</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">6<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /><br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Payment</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPaymentsContragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">paymentLimitDate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Нужно стандартизировать инн<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">dataManager.load(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Payment</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .query(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select p from rtneo$Payment p where p.inn like :inn and p.createTs &lt;= :paymentLimitDate'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;%%&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />            .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;paymentLimitDate&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">paymentLimitDate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .view(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'_local'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .list();<br />}<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">value</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">value </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">== </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">? </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ZERO </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">value</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />}<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getBillsOnPeriod</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">UUID </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragentID</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">period</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ViewRepository </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">viewRepository = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ViewRepository</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">View </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">acView = viewRepository.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />    acView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contractPosition&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, viewRepository.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContractPosition</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragentRealEstate&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, viewRepository.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentRealEstate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)))<br />            .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;createTs&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;createdBy&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; contracts = dataManager.load(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .query(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select e from rtneo$Contract e where e.contragent.id = :contragent and e.accepted=true and not (e.createTs &gt; :contractLimit and e.createdBy = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">a.kotvinskiy@groupstp.ru</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">) order by e.createTs desc'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragent&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragentID</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contractLimit&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, contractLimit)<br />            .view(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .list();<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contracts.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() == </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />        contracts = dataManager.load(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .query(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select e from rtneo$Contract e where e.contragent.id = :contragent and not (e.createTs &gt; :contractLimit and e.createdBy = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">a.kotvinskiy@groupstp.ru</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">) order by e.createTs'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragent&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragentID</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contractLimit&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, contractLimit)<br />                .view(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .list();<br />    }<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contracts.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() &gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">int </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">i = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">contract = contracts.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(i);<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getFrom</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() == </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">while </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getFrom</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() != </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&amp; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">period</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">before</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getFrom</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())) {<br />            i = i + </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(i == contracts.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()) </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">break</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />            contract = contracts.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(i);<br />        }<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">sdf = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;yyyy-MM-dd&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getFrom</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() != </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; accruals = dataManager.load(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                    .query(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select e from rtneo$Accrual e where e.contractPosition.contract.id=:contractId and e.period=:period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                    .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contractId&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, contract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />                    .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;period&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">period</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                    .view(acView)<br />                    .list();<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">accruals;<br />        }<br />    }<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">public </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getContragentBills</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">UUID </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragentID</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ViewRepository </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">vRep = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ViewRepository</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">View </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">viewAccrual = vRep.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;category&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, vRep.getView(RealEstateCategory.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                    .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;unit&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, vRep.getView(Unit.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />            )<br />            .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;realEstate&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, vRep.getView(RealEstate.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br />            )<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">sqlQuery = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select e from rtneo$Accrual e where 1=0'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; accruals = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ArrayList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt;();<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; contracts = dataManager.load(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .query(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select e from rtneo$Contract e where e.contragent.id = :contragent and e.accepted =true order by e.createTs desc'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragent&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragentID</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .view(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contract-edit&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .list();<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contracts.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() &gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">sdf = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;yyyy-MM-dd&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">lastContract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: contracts) {<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(lastContract == </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />                lastContract = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />                sqlQuery = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'cast(a.contractPosition.contract.id text)=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+ </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toString</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() + </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;"> '</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />            } </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getFrom</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">before</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(lastContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getFrom</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())) {<br />                    sqlQuery = sqlQuery + </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">' or (cast(a.contractPosition.contract.id text)=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+ </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toString</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() + </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;"> and a.period &lt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+ sdf.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">format</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(lastContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getFrom</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()) + </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;"> )'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />                    lastContract = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />                }<br />            }<br />        }<br />        sqlQuery = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select a from  rtneo$Accrual a where a.contragent.id = :contragentID and  (' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+ sqlQuery + </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">')  order by a.period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /><br />        accruals = dataManager.load(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .query(sqlQuery)<br />                .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragentID&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragentID</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .view(viewAccrual)<br />                .list();<br />    }<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">accruals;<br />}<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">public </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getContragentBills</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">UUID </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragentID</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">from</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">to</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ViewRepository </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">vRep = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ViewRepository</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DataManager </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">dataManager = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DataManager</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">View </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">viewAccrual = vRep.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;category&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, vRep.getView(RealEstateCategory.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                    .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;unit&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, vRep.getView(Unit.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />            )<br />            .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;realEstate&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, vRep.getView(RealEstate.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br />            )<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">sqlQuery = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select e from rtneo$Accrual e where 1=0'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; accruals = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ArrayList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt;();<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; contracts = dataManager.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">load</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">query</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select e from rtneo$Contract e where e.contragent.id = :contragent and e.accepted =true order by e.createTs desc'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parameter</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragent&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragentID</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">view</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contract-edit&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">list</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contracts.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() &gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">sdf = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;yyyy-MM-dd&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">lastContract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: contracts) {<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(lastContract == </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />                lastContract = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />                sqlQuery = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'cast(a.contractPosition.contract.id text)=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+ </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toString</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() + </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;"> '</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />            } </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">from</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">before</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(lastContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getFrom</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())) {<br />                    sqlQuery = sqlQuery + </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">' or (cast(a.contractPosition.contract.id text)=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+ </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toString</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() + </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;"> and a.period &lt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+ sdf.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">format</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">to</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) + </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;"> )'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />                    lastContract = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />                }<br />            }<br />        }<br />        sqlQuery = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select a from  rtneo$Accrual a where a.contragent.id = :contragentID and  (' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+ sqlQuery + </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">')  order by a.period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /><br />        accruals = dataManager.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">load</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">query</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(sqlQuery)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parameter</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragentID&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragentID</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">view</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(viewAccrual)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">list</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br />    }<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">accruals;<br />}<br /><br /><br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">/**<br /> * Логирование<br /> */<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.app.serialization.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">EntitySerializationAPI</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.groupstp.rtneo.util.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">JsonUtil</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.text.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.text.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">private </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">... </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">options</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">== </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;LOG.ERROR: Object is null!!!&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">options</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() == </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">option </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">options</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">option</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;str&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">option</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;for&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">each</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">option</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;json&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">EntitySerializationAPI </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">entitySerializationAPI = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">EntitySerializationAPI</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">try</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(entitySerializationAPI.toJson(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))}<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">catch</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Exception </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;LOG.ERROR: JSON entity serialization failed&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br />        }<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">option</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;objJson&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">JsonUtil </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">jsonUtil = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">JsonUtil</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">try</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{log.(jsonUtil.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toJson</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))}<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">catch</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Exception </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;LOG.ERROR: JSON object serialization failed&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br />        }<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">option</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;date&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DateFormat </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">df = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;dd.MM.yyyy&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">try</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(df.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">format</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))}<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">catch</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Exception </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;LOG.ERROR: Failed date format&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br />        }<br />    }<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">private </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){log.debug(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}</span></pre></body></html>