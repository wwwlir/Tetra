<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы вызвать диалог создания новой записи, можно выполнить <a href="https://webhamster.ru/site/page/index/articles/projectcode/495"><span style=" text-decoration: underline; color:#0000ff;">консольную команду MyTetra</span></a> с опциями &quot;--control --addNoteDialog&quot;. Получив такую команду, MyTetra откроет диалог добавления новой записи. Принцип действия полностью аналогичен <a href="https://webhamster.ru/site/page/index/articles/projectcode/499"><span style=" text-decoration: underline; color:#0000ff;">открытию окна MyTetra по глобальной горячей клавише</span></a>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Однако, если сделать просто открытие диалога добавления записи, то будет ли такое поведение удобно? Нет, потому что <span style=" font-weight:600;">новая запись добавляется в текущей ветке</span>. Нажимая глобальную горячую клавишу, обычно не видно, какая ветка выбрана. Да и во время работы с MyTetra у пользователя открыты все время разные ветки. Поэтому после такого добавления записи пользователь должен будет сразу переместить запись из текущей ветки в нужную ветку, чтобы не наводить в базе бардак. А не все пользователи такие пунктуальные. Поэтому добавление новой записи лучше сделать немного по-другому.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Во-первых, надо создать ветку с говорящим названием &quot;Входящие&quot; или &quot;Неразобранные&quot;, именно в нее будут добавляться записи по глобальной горячей клавише. Далее нужно узнать ID этой ветки. Для этого можно заглянуть в файл mytetra.xml и найти название ветки по имени (смотреть нужно теги &lt;node&gt;). Если ветка зашифрована, то понять, где находится строка с ее описанием, можно просто по расположению в дереве. Пусть найденный ID будет равен, к примеру, 1540715849a3hrpjk4ix.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Далее, в случае Linux, нужно рядом со скриптом mytetra.run сделать скрипт mytetraAddNote.run следующего содержания (для Windows нужно сделать что-то аналогичное в *.bat-файле):</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">#!/bin/sh<br /><br />PROGDIR=$(dirname $(readlink -e $0))<br />cd $PROGDIR</span><br /><span style=" font-family:'FreeMono'; color:#6a1009;"><br />./mytetra.run --control --openTreeItem 1540715849a3hrpjk4ix<br />./mytetra.run --control --addNoteDialog</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При запуске, данный скрипт даст вначале команду переключения на ветку &quot;Входящие&quot; (опция --openTreeItem), а затем откроет диалог создания новой записи (опция --addNoteDialog). Если ветка была зашифрована, потребуется, как обычно, ввести пароль.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Внимание!</span> В экспериментальной ветка пока есть проблема: если в момент выполнения данного скрипта окно MyTetra было свернуто в трей, то после добавления записи будет происходить сегфолт. Это как-то связано с закрытием модального окна, у которого основное окно свернуто. Пока эта проблема не решена, и чтобы ее обойти, надо первой командой в скрипте дать команду --show.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Можно сразу проверить работу скрипта, просто запустив его. Должно появляться окно добавления новой записи. Добавленная запись попадет в ветку &quot;Входящие&quot;. Данный скрипт с полным путем к нему надо навесить на нужную комбинацию клавиш, так же, как это делалось для команды открытия окна MyTetra (автор испльзует комбинацию Alt+Ins).</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Почему нельзя было воспользоваться сцепкой команд, и просто написать для горячей клавиши вот такую команду:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">/home/USER/work/mytetra/mytetra.run -openTreeItem 1540715849a3hrpjk4ix ; /home/USER/work/mytetra/mytetra.run --control --addNoteDialog</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Потому что программы конфигурирования горячих клавиш ведут себя не всегда адекватно, когда задается больше одной команды в командной строке. Программа lxhotkey начинает вызывать только последнюю в строке команду, игнорируя первую. Поэтому со скриптом надежнее и проще.</p></body></html>