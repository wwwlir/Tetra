<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#282c34;"><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.util.*<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.global.*<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.entity.*;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.groupstp.rtneo.entity.*<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.entity.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">FileDescriptor<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.app.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">FileStorageAPI<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.io.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">InputStream<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.io.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">InputStreamReader<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.io.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ByteArrayOutputStream<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">org.apache.commons.io.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">IOUtils<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.nio.charset.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">StandardCharsets</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.opencsv.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CSVReader</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.groupstp.rtneo.service.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BillService<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.text.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">org.apache.commons.collections.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CollectionUtils<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.util.stream.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Collectors</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.groupstp.rtneo.core.bean.tools.*<br /><br />df1 = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;yyyy-MM-dd&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">dateView = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;dd-MM-yyyy&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">period1 = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'2020-01-01'<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">period2 = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'2020-09-01'<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">paymentLimit = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'2020-10-23'<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">contractLimit = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'2020-10-01'<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//def prolongationLimit1 = df1.parse('2020-07-08')<br />//def prolongationLimit2 = df1.parse('2020-07-09')<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">FileStorageAPI </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">fileStorageAPI=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">FileStorageAPI</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BillService </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">billService = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BillService</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DatePeriodTools </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">datePeriodTools = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DatePeriodTools</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Контрагенты из файла<br />//String id='52513a70-421d-4d9b-bee3-1575f58d7e0a'<br />//List&lt;String&gt; listInn = inToFile(id)<br />//<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">idEx=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'308e6069-5d3a-aee2-01b5-e3d6761ce573'<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; listExInn = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">inToFile</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(idEx)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//List&lt;String&gt; listExInn = new ArrayList&lt;&gt;()<br />//<br />//List&lt;String&gt; unique = new ArrayList&lt;&gt;()<br />//<br />//for(String item : listInn){<br />//    if(listExInn.stream().anyMatch{e -&gt; e.equals(item)})continue<br />//    unique.add(item)<br />//}<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">tariffs = dataManager.loadValues(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select t.tariff*1.2, t.dateSince, t.dateTill from rtneo$Tariff t where t.name = 1'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        .properties(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;tariff&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;from&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;to&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        .list()<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">periodEnd   = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getInstance</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br />periodEnd.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setTime</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(df1.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(period2));<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">paymentLimitDate = df1.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(paymentLimit)<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">beginYear = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getInstance</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br />beginYear.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setTime</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(df1.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;2019-01-01&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">));<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">i = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//ААА3801011440<br />//ААА3801012412<br />//Ф380101342472<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">contragents = dataManager<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//        .loadValues('select distinct c.id, c.inn, c.kpp, c.personalAccount, (select count(ct) from rtneo$Contract ct where ct.contragent.id = c.id and ct.accepted = true and ct.isFactCalculation = true) from rtneo$Contragent c where c.inn in :exclude and not c.personalAccount is null and size(c.contracts) &gt; 0 except select distinct c.id, c.inn, c.kpp, c.personalAccount, (select count(ct) from rtneo$Contract ct where ct.contragent.id = c.id and ct.accepted = true and ct.isFactCalculation = true) from rtneo$Contract ct join rtneo$Contragent c on ct.contragent.id = c.id where c.inn in :exclude and ct.template = \'MSG310820\'')<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.loadValues(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select distinct c.id, c.inn, c.kpp, c.personalAccount, (select count(ct) from rtneo$Contract ct where ct.contragent.id = c.id and ct.accepted = true and ct.isFactCalculation = true) from rtneo$Payment e join rtneo$Contragent c on e.inn = c.inn where not e.inn is null and e.createTs &lt;= :paymentLimitDate order by c.inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        .properties(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;id&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;inn&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;kpp&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;pa&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;fact&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        .firstResult(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        .maxResults(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">100</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;paymentLimitDate&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, paymentLimitDate)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//        .parameter(&quot;exclude&quot;, listExInn)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.list();<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//void </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#61afef;">checkContragent</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">(){<br />//<br />//}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">accrualsGroup = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">TreeMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;();<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">contragentsGroup = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">TreeMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;();<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Коллекция исключенных объектов<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Map</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; excluded = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Формируем структуру данных<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: contragents){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Исключаем контрагентов с филиалами<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contragents.stream().filter</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) == </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.count() &gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        excluded.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">putIfAbsent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">), </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;Filial&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">continue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />    }<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'fact'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) == </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        excluded.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">putIfAbsent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">), </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;no Fact&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">continue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />    }</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />        excluded.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">putIfAbsent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">), </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;Fact&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    }<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//------------------------------------------------<br />    //Исключаем контрагентов у кого есть арендаторы за которых он платит, не из БТ и нет перерасчета по факту за 2019 год<br />//    def isRent = dataManager.loadValue('select count(r) from rtneo$RealEstateRenter r where r.contragentRealEstate.contragent.id = :contragent and r.payOwner = true and (select count(c) from rtneo$Contract c where c.contragent.id = r.contragentRealEstate.contragent.id and (c.loadedFromBigTrio = true or (c.accepted = true and c.isFactRecalculation = true))) = 0', Integer.class)<br />//        .parameter(&quot;contragent&quot;, contragent.getValue('id'))<br />//        .optional().orElse(0)<br />//    if(isRent &gt; 0){<br />//        excluded.putIfAbsent(contragent.getValue('inn'), &quot;Rent&quot;)<br />//        continue<br />//    }<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">payments = dataManager.load(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Payment</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .query(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select p from rtneo$Payment p where p.inn like :inn and p.createTs &lt;= :paymentLimitDate'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;%%&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />            .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;paymentLimitDate&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, paymentLimitDate)<br />            .view(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'_local'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .list();<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(payments.size() == </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">continue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contragentsGroup[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)] == </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        contragentsGroup[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)] =[<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'id'  </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'id'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">),<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">),<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'kpp' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'kpp'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">),<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'pa' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'pa'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        ]<br />    }<br /><br />    contragentsGroup[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'payments'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] = [:];<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">payment </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: payments){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contragentsGroup[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'payments'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">][dateView.format(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">payment</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getDate())] == </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />            contragentsGroup[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'payments'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">][dateView.format(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">payment</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getDate())] = [<br />                    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'purpose' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">payment</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getPurpose(),<br />                    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'sum' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">payment</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getSum()<br />            ]<br />        }</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />            contragentsGroup[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'payments'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">][dateView.format(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">payment</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getDate())][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'sum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] += </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">payment</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getSum();<br />        }<br />    }<br />    contragentsGroup[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'accruals'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] = [:];<br />    accrualsGroup = [:];<br />    beginYear.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setTime</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(df1.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;2019-01-01&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">));<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">failTariff = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">actualProlongation = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">factAccrual = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">zeroAccrual = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">minusAccrual = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br /><br />    while</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(!beginYear.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">after</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(periodEnd)){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; accruals = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getBillsOnPeriod</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">UUID</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">fromString</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'id'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).toString()), beginYear.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTime</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">tariff = tariffs.stream().filter</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">datePeriodTools.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">isPeriodIncluded</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(beginYear.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTime</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(), </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'from'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">), </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'to'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.findFirst().orElse(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">roundingTarif = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(tariff.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'tariff'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setScale</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">5</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ROUND_HALF_UP</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: accruals){<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//            if(!accrual.getPrice().equals(roundingTarif)){<br />//                failTariff = true<br />//            }<br /><br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPrice</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;594.52800&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))){<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//                failTariff = true<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getComment</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;По факту&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />                factAccrual = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />                continue<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//            _(&quot;${contragent.getValue('pa')} ${accrual.getComment()}&quot;)<br />//            if(accrual.getCreateTs().compareTo(prolongationLimit1) == 1 &amp;&amp; accrual.getCreateTs().compareTo(prolongationLimit2) == -1 &amp;&amp; accrual.getCreatedBy().equals(&quot;a.kotvinskiy@groupstp.ru&quot;)){<br />//                actualProlongation = true<br />//            }<br /><br />//            BigDecimal sum = accruals.stream()<br />//                .map{a -&gt; a.getTotalSum()}<br />//                .reduce{u1, u2 -&gt; u1.add(u2)}<br />//                .orElse(0);<br /><br />//            if(sum == 0){<br />//                zeroAccrual = true<br />//            }<br />//            if(sum &lt; 0){<br />//                minusAccrual = true<br />//            }<br /><br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">tariffNoNDS = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPrice</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() != </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">? </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPrice</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()*</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">5</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">/</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">6 </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(accrualsGroup[dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">format</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPeriod</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())]==</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />                accrualsGroup[dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">format</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPeriod</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())] = [<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'period' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">format</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPeriod</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()),<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'number' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getDocumentNumber</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(),<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'tariff' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: tariffNoNDS,<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'amountBase' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getAmountBase</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()),<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSumBaseNoNds' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getAmountBase</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())*tariffNoNDS,<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSumBase' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTotalSumBase</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()),<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTotalSum</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()),<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'nds' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNds</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()),<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'residue' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,<br />                        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'done' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]<br />            }</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />                accrualsGroup[dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">format</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPeriod</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'amountBase'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] += </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getAmountBase</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />                accrualsGroup[dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">format</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPeriod</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSumBaseNoNds'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] += </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getAmountBase</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())*tariffNoNDS<br />                accrualsGroup[dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">format</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPeriod</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSumBase'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] += </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTotalSumBase</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />                accrualsGroup[dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">format</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPeriod</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] += </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTotalSum</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />            }<br />        }<br />        beginYear.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">add</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">MONTH</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br />    }<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//    if(failTariff){<br />//        excluded.putIfAbsent(contragent.getValue('inn'), &quot;Fail tariff 594.52800&quot;)<br />//        continue<br />//    }<br /><br />//    if(factAccrual){<br />//        excluded.putIfAbsent(contragent.getValue('inn'), &quot;Faact accrual&quot;)<br />//        continue<br />//    }<br />//<br />//    if(actualProlongation){<br />//        excluded.putIfAbsent(contragent.getValue('inn'), &quot;Actual prolongation&quot;)<br />//        continue<br />//    }<br /><br />//    if(zeroAccrual){<br />//        excluded.putIfAbsent(contragent.getValue('inn'), &quot;Zero accrual&quot;)<br />//        continue<br />//    }<br />//    if(minusAccrual){<br />//        excluded.putIfAbsent(contragent.getValue('inn'), &quot;Minus accrual&quot;)<br />//        continue<br />//    }<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">accrualsGroup.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">each</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(!(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">].compareTo(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSumBase'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]) == </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">noNdsSum = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]/(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">100</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'nds'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">])*</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">100<br />            it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().put(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'amountBase'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, noNdsSum/</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'tariff'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">])<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//            excluded.putIfAbsent(contragent.getValue('inn'), &quot;discount&quot;)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">contragentsGroup[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'accruals'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] = accrualsGroup;<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Выводим исключенные<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;-----------Excluded------------&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />excluded.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">each</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;--------------End--------------&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Форматируем данные для вывода<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">res = [:]<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contr </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: contragentsGroup){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">sumPay = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">residue = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0<br />    contr</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'payments'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">].</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">each</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">p </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">sumPay += </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">p</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'sum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">res[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contr</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]] = [<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'id'  </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contr</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'id'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">],<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contr</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">],<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'kpp' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contr</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'kpp'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">],<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'pa' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contr</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'pa'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">],<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'sumPayments' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: sumPay,<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'accruals'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: [:]<br />    ]<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//    def accrual = []<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrualFor </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contr</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'accruals'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(sumPay &gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrualFor</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrualFor</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'done'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrualFor</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'done'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(sumPay &gt;= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />            residue = sumPay<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrualFor</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'residue'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] = residue<br />        }<br />        sumPay -= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrualFor</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]<br /><br /><br /><br />        res[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contr</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'accruals'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">][</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrualFor</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]]=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accrualFor<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />}<br />res.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">each</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">endMonth   = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getInstance</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br />endMonth.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setTime</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(df1.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(period1));<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; totalsNullAccrualContract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ArrayList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt;&gt; zeroMap = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; zeroList = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ArrayList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; excledeOutList = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ArrayList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;!Наименование услуги!Дата договора!Основной договор!Номер УПД!Дата УПД!Дата корр.!ИНН!КПП!ЛС!Объем!Цена без НДС!Сумма без НДС!НДС!Цена с НДС!Оплачен период!Остаток на начало периода&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemRes </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: res){<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(excluded.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">keySet</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">stream</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">anyMatch</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemRes</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">])</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">continue<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; contractList = dataManager.load(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .query(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select c from rtneo$Contract c where c.contragent.id = :contragent and c.accepted is not null and c.accepted = true and (c.createTs &lt; :contractLimit and not c.createdBy = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">a.kotvinskiy@groupstp.ru</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">) order by c.createTs'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragent&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemRes</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'id'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">])<br />            .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contractLimit&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, df1.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contractLimit))<br />            .view(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contract-browse&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .list()<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">keyOutput = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />    def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">excledeOut = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; excludeMap = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemRes</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'accruals'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getKey()).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">compareTo</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(df1.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(period1))&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">continue<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//        _(item)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">total = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValue().getValue()<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">].</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toString</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">compareTo</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'01-01-2020'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)) == </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0 </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&amp;&amp; total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'residue'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">] &lt;= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0 </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&amp;&amp; !total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'residue'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">])excledeOut = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">endMonth.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setTime</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">].</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toString</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()));<br />        endMonth.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">set</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">DAY_OF_MONTH</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, endMonth.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getActualMaximum</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">DAY_OF_MONTH</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">month = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTextPeriod</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]))<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Выводим один не оплаченный месяц<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'done'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]!=</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&amp;&amp; !keyOutput){<br />            keyOutput = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'done'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]!=</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&amp;&amp; keyOutput){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">continue<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(excledeOut){<br />            excludeMap.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;inn&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemRes</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">])<br />            excludeMap.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;kpp&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemRes</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'kpp'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">])<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//    excledeOutList.add(&quot;!Услуга Регионального оператора по обращению с ТКО за ${month}!!!!${dateView.format(endMonth.getTime())}!!${itemRes.getValue()['inn']}!${itemRes.getValue()['kpp']}!${itemRes.getValue()['pa']}!!!!!!${total['done']==true?'да':'нет'}!${total['residue']}&quot;)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />            log.debug(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;!Услуга Регионального оператора по обращению с ТКО за </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">month</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!!!!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">format</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(endMonth.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTime</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemRes</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemRes</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'kpp'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">itemRes</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'pa'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!!!!!!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'done'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]==</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">?</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'да'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">:</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'нет'</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'residue'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        }<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; itemsList = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ArrayList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: contractList){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">KeyValueEntity </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">totalAccrualContract = dataManager.loadValues(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select a.documentNumber, max(a.period), sum(a.amountBase), sum(a.amountBase)*max(a.price), max(a.price), sum(a.ndsSum), sum(a.totalSum), sum(a.totalSumBase) from rtneo$Accrual a where a.contractPosition.contract.id = :contract and a.period = :period group by a.documentNumber'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                    .properties(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;number&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;period&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;amount&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;totalSumWithNDS&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;price&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;totalNDS&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;totalSum&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;totalSumBase&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                    .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contract&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />                    .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;period&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(total[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]))<br />                    .optional()<br />                    .orElse(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//            if(totalAccrualContract == null){<br />//                totalsNullAccrualContract.add(itemRes.getValue()['inn'])<br />//                continue<br />//            }<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">mainContractNumber = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getMainContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() != </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">? </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getMainContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNumber</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() : </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">''<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; mapResults = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br /><br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(totalAccrualContract == </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//                _(&quot;!${contract.getNumber()}!No accruals in to period&quot;)<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />                mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cnumber&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNumber</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />                mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cdate&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getMainContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()!=</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">? </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">format</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getDate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()))<br />                mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cmnumber&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, mainContractNumber)<br />                mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;number&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'number'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />                mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;period&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">format</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(endMonth.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTime</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()))<br />                mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;dateCor&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getMainContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()!=</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">?dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">format</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getDate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()):</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">''</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;amount&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'amount'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />                mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;price&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'price'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)*</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">5</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">/</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">6</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">totalNDS = totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalNDS'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) == </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">? </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ZERO </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalNDS'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;totalSumNoNDS&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) - totalNDS)<br />                mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;totalNDS&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, totalNDS)<br />                mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;totalSum&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br /><br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(!(totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).compareTo(totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSumBase'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)) == </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />                    mapResults.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'amount'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)/totalAccrualContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'price'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />                }<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//                accrualsGroup.each{<br />//                    if(!(it.getValue()['totalSum'].compareTo(it.getValue()['totalSumBase']) == 0)){<br />//                        BigDecimal noNdsSum = it.getValue()['totalSum']/(100+it.getValue()['nds'])*100<br />//                        it.getValue().put('amountBase', noNdsSum/it.getValue()['tariff'])<br />//            //            excluded.putIfAbsent(contragent.getValue('inn'), &quot;discount&quot;)<br />//                    }<br />//                }<br /><br /><br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">add</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(mapResults)<br />            }<br /><br />        }<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">print1Contract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">print2Contract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />        if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()&gt;=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(!itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'cdate'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">''</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />                print1Contract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() == </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)print1Contract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /><br /><br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()&gt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//для 20го года Сделать условие!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(!itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'cdate'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">''</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) &amp;&amp; dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'cdate'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">compareTo</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(dateView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'01-01-2020'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)) &lt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)print1Contract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br /><br />                if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(!itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'cdate'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">''</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) &amp;&amp; !itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()-</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'cdate'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">''</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />                    print1Contract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//                if(itemsList.get(0).get('cdate').equals('') &amp;&amp; itemsList.get(itemsList.size()-1).get('cdate').equals(''))itemsList.get(itemsList.size()-1)['dateCor'] = ''<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()-</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)))print1Contract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br /><br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">print2Contract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />        }<br /><br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(excledeOut){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(print1Contract){<br />                excludeMap.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;number&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;number&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />                excledeOutList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">add</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(excludeMap)<br />            }<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(print2Contract){<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">excludeMapC = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;(excludeMap)<br />                excludeMapC.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;number&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()-</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;number&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />                excledeOutList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">add</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(excludeMapC)<br />            }<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//            if(print1Contract)excledeOutList.add(itemsList.get(0))<br />//            if(print2Contract)excledeOutList.add(itemsList.get(itemsList.size()-1))<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(print1Contract)</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">printItemFromResultMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(print2Contract)</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">printItemFromResultMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(itemsList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()-</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />        }<br />    }<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'****************************************************************************'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br />excledeOutList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">each</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">instanceof </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;|</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'inn'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">|</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'kpp'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">|</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'number'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    }</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    }<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//HashSet(totalsNullAccrualContract).each{_(it)}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return true</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Не используется<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">itemResultComparator </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">implements </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Comparator</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt;&gt;{<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">public int </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">compare</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">a</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">b</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(((</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">a</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cnumber&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">((</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">a</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cnumber&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)))</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(((</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">a</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cnumber&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)).lenght() &gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">3 </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&amp;&amp; ((</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">b</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cnumber&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)).lenght()&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">3</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(((</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">a</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cnumber&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)).lenght() &lt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">3 </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&amp;&amp; ((</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">b</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cnumber&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)).lenght()&gt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">3</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">-</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">((</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">a</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cnumber&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">compareTo</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">((</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">b</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cnumber&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">));<br />    }<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">void </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">printItemFromResultMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'cnumber'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'cdate'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'cmnumber'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'number'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'dateCor'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!!!!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'amount'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'price'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSumNoNDS'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalNDS'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">current</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'totalSum'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getTextPeriod</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">result=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">''<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">!= </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">monthesRP = [</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'январь'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'февраль'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'март'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'апрель'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'май'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'июнь'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'июль'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'август'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'сентябрь'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'октябрь'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'ноябрь'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">,</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'декабрь'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">cal = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getInstance</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />        cal.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setTime</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />        result+=monthesRP[cal.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">MONTH</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)]<br />        result+=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot; &quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+cal.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Calendar</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">YEAR</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toString</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()+</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot; г.&quot;<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">result<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getNN</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">value</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">value </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">== </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">? </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">BigDecimal</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">ZERO </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">value</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />}<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.global.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ViewRepository</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.global.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">View</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">public </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getBillsOnPeriod</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">UUID </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragentID</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">period</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ViewRepository </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">viewRepository = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ViewRepository</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">View </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">acView = viewRepository.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />    acView.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contractPosition&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, viewRepository.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContractPosition</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragentRealEstate&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, viewRepository.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentRealEstate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)))<br />            .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;createTs&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;createdBy&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; contracts = dataManager.load(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .query(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select e from rtneo$Contract e where e.contragent.id = :contragent and e.accepted=true and not (e.createTs &gt; :contractLimit and e.createdBy = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">a.kotvinskiy@groupstp.ru</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">) order by e.createTs desc'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragent&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragentID</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contractLimit&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, df1.parse(contractLimit))<br />            .view(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .list();<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contracts.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() == </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />        contracts = dataManager.load(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .query(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select e from rtneo$Contract e where e.contragent.id = :contragent and not (e.createTs &gt; :contractLimit and e.createdBy = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">a.kotvinskiy@groupstp.ru</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">) order by e.createTs'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragent&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragentID</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contractLimit&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, df1.parse(contractLimit))<br />                .view(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .list();<br />    }<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contracts.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() &gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">int </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">i = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">contract = contracts.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(i);<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getFrom</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() == </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">while </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getFrom</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() != </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&amp; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">period</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">before</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getFrom</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())) {<br />            i = i + </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(i == contracts.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()) </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">break</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />            contract = contracts.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(i);<br />        }<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">sdf = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;yyyy-MM-dd&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getFrom</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() != </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; accruals = dataManager.load(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                    .query(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select e from rtneo$Accrual e where e.contractPosition.contract.id=:contractId and e.period=:period'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                    .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contractId&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, contract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />                    .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;period&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">period</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                    .view(acView)<br />                    .list();<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">accruals;<br />        }<br />    }<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />}<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">inToFile</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">id</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">FileDescriptor </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">fd = dataManager.load(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">FileDescriptor</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .id(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">UuidProvider</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">fromString</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">id</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />            .view(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">View</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">MINIMAL</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .optional().orElse(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(fd == </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">throw new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">RuntimeException</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;fileNotFound&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">FileStorageAPI </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">fileStorageAPI=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">FileStorageAPI</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">InputStream </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">inputStream=fileStorageAPI.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">openStream</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(fd)<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CSVReader </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">reader = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CSVReader</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">InputStreamReader</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(inputStream, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;UTF-8&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">));<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">reader.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">readAll</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">stream</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />            .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">map</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">[</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">]</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">collect</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Collectors</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />}<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">/**<br /> * Логирование<br /> */<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.app.serialization.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">EntitySerializationAPI</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.groupstp.rtneo.util.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">JsonUtil</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.text.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.text.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">private </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">... </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">options</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">== </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;LOG.ERROR: Object is null!!!&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">options</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() == </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">option </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">options</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">option</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;str&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">option</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;for&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">each</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">option</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;json&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">EntitySerializationAPI </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">entitySerializationAPI = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">EntitySerializationAPI</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">try</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(entitySerializationAPI.toJson(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))}<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">catch</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Exception </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;LOG.ERROR: JSON entity serialization failed&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br />        }<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">option</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;objJson&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">JsonUtil </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">jsonUtil = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">JsonUtil</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">try</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{log.(jsonUtil.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toJson</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))}<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">catch</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Exception </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;LOG.ERROR: JSON object serialization failed&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br />        }<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">option</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;date&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DateFormat </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">df = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;dd.MM.yyyy&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">try</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(df.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">format</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))}<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">catch</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Exception </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;LOG.ERROR: Failed date format&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br />        }<br />    }<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">private </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){log.debug(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}</span></pre></body></html>