<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="content"></a>OAuth токен необходим для выполнения любого метода REST API (кроме случая <a href="https://doc.cuba-platform.com/manual-6.10-ru/rest_api_v2_anonymous.html"><span style=" text-decoration: underline; color:#0000ff;">анонимного доступа к REST API</span></a>). Получить токен можно выполнив POST запрос по адресу </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">http://localhost:8080/app/rest/v2/oauth/token</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Доступ к данному URL защищен с помощью базовой аутентификации с использованием идентификатора и пароля клиента REST API. Обратите внимание, что это не логин и пароль пользователя приложения. Идентификатор и пароль клиента REST API заданы в свойствах приложения <a href="https://doc.cuba-platform.com/manual-6.10-ru/app_properties_reference.html#cuba.rest.client.id"><span style=" text-decoration: underline; color:#0000ff;">cuba.rest.client.id</span></a> и <a href="https://doc.cuba-platform.com/manual-6.10-ru/app_properties_reference.html#cuba.rest.client.secret"><span style=" text-decoration: underline; color:#0000ff;">cuba.rest.client.secret</span></a> (значения по умолчанию для этих свойств: <span style=" font-family:'monospace';">client</span> и <span style=" font-family:'monospace';">secret</span>). Заголовок Authorization запроса на получение токена должен содержать логин и пароль клиента, разделенные символом &quot;:&quot; и закодированные в base64. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Тип запроса на получение токена должен быть <span style=" font-family:'monospace';">application/x-www-form-urlencoded</span>, кодировка <span style=" font-family:'monospace';">UTF-8</span>. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Запрос должен содержать следующие параметры: </p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">grant_type</span> - всегда значение <span style=" font-family:'monospace';">password</span>. </li>
<li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">username</span> - логин пользователя приложения. </li>
<li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">password</span> - пароль пользователя приложения. </li></ul>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">POST /oauth/token</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">Authorization: Basic Y2xpZW50OnNlY3JldA==</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">Content-Type: application/x-www-form-urlencoded</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">grant_type=password&amp;username=smith&amp;password=qwerty123</span> </pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вы также можете использовать утилиту <a href="https://curl.haxx.se/"><span style=" text-decoration: underline; color:#0000ff;">cURL</span></a>: </p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">curl -H &quot;Content-type: application/x-www-form-urlencoded&quot; -H &quot;Authorization: Basic Y2xpZW50OnNlY3JldA==&quot; -d &quot;grant_type=password&amp;username=admin&amp;password=admin&quot; http://localhost:8080/app/rest/v2/oauth/token</span> </pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Метод возвращает JSON объект: </p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">  &quot;access_token&quot;: &quot;29bc6b45-83cd-4050-8c7a-2a8a60adf251&quot;,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">  &quot;token_type&quot;: &quot;bearer&quot;,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">  &quot;refresh_token&quot;: &quot;e765446f-d49e-4634-a6d3-2d0583a0e7ea&quot;,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">  &quot;expires_in&quot;: 43198,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">  &quot;scope&quot;: &quot;rest-api&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">}</span> </pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Значение токена содержится в поле <span style=" font-family:'monospace';">access_token</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы использовать токен, его нужно передать в заголовке запроса <span style=" font-family:'monospace';">Authorization</span> с типом <span style=" font-family:'monospace';">Bearer</span>, например: </p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">Authorization: Bearer 29bc6b45-83cd-4050-8c7a-2a8a60adf251</span> </pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Свойство <span style=" font-family:'monospace';">refresh_token</span> содержит значение refresh токена. Он не может быть использован для доступа к защищённым ресурсам приложения, но он имеет большее время жизни по сравнению с access токеном и используется для получения нового access токена, когда старый токен истек. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Запрос на получение нового access токена с помощью refresh токена должен содержать следующие параметры: </p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">grant_type</span> - <span style=" font-family:'monospace';">refresh_token</span>. </li>
<li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">refresh_token</span> - значения refresh токена. </li></ul>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">POST /oauth/token</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">Authorization: Basic Y2xpZW50OnNlY3JldA==</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">Content-Type: application/x-www-form-urlencoded</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">grant_type=refresh_token&amp;refresh_token=e765446f-d49e-4634-a6d3-2d0583a0e7ea</span> </pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">См. также следующие свойства приложения, имеющие отношение к токенам: </p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://doc.cuba-platform.com/manual-6.10-ru/app_properties_reference.html#cuba.rest.client.tokenExpirationTimeSec"><span style=" text-decoration: underline; color:#0000ff;">cuba.rest.client.tokenExpirationTimeSec</span></a> </li>
<li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://doc.cuba-platform.com/manual-6.10-ru/app_properties_reference.html#cuba.rest.client.refreshTokenExpirationTimeSec"><span style=" text-decoration: underline; color:#0000ff;">cuba.rest.client.refreshTokenExpirationTimeSec</span></a> </li>
<li style="" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://doc.cuba-platform.com/manual-6.10-ru/app_properties_reference.html#cuba.rest.client.authorizedGrantTypes"><span style=" text-decoration: underline; color:#0000ff;">cuba.rest.client.authorizedGrantTypes</span></a> </li></ul>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000;"><br /></p></body></html>