<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#282c34;"><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.entity.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Entity<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.global.*<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.groupstp.rtneo.entity.*<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.groupstp.rtneo.service.*<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.groupstp.rtneo.core.bean.*<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.global.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ViewRepository</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.global.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">View</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.util.function.*;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">TransactionalDataManager<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.math.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">RoundingMode</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">org.apache.commons.collections4.*;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.text.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.text.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.bali.util.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Preconditions</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">org.slf4j.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Logger</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">org.slf4j.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">LoggerFactory</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">de.diedavids.cuba.runtimediagnose.groovy.*<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Нужно ли делать снапшот? Если да, то нужно раскомментировать создание снапшотов<br />//в методах createContractForCRE и createSuppContractForCRE. А также в расчетах по среднему<br />//SnapshotHistoryService snapshotHistoryService = AppBeans.get(SnapshotHistoryService.NAME);<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">df = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;dd.MM.yyyy&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Только офферта<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">onlyOffer = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">cleanFailed = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">cleanOffer = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Отрефакторить<br />//Период договоров<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">start = df.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'01.01.2019'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />end = df.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'31.12.2019'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Дата допа<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">contractDate = df.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;30.06.2019&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">year2020 = df.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'01.01.2020'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">interface </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">MyPredicate </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">T</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">U</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">C</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt;{</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">test</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">T </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">t</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">U </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">u</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">C </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">c</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">MyPredicate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentRealEstate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; crePred1 = </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">from</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">to</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt;<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValidityFrom() == </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">|| </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValidityFrom().compareTo(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">to</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)&lt;=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">MyPredicate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentRealEstate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; crePred2 = </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">from</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">to</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt;<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValidityFrom().compareTo(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">from</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)&gt;=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0 </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&amp;&amp; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getValidityFrom().compareTo(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">to</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)&lt;=</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Разделение объектов<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">LinkedHashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt;&gt; includedPeriod = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;();<br />includedPeriod.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">putIfAbsent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cre1&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, [</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;from&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;to&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: df.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'01.01.2019'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">), </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;pred&quot; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: crePred1])<br />includedPeriod.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">putIfAbsent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cre2&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, [</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;from&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: df.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'02.01.2019'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">), </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;to&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: df.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'30.04.2019'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">), </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;pred&quot; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: crePred2])<br />includedPeriod.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">putIfAbsent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cre3&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, [</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;from&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: df.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'01.05.2019'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">), </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;to&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: df.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'31.12.2019'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">), </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;pred&quot; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: crePred2])<br />includedPeriod.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">putIfAbsent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cre5&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, [</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;from&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: df.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'31.12.2019'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">), </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;to&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: df.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'31.12.2020'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">), </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;pred&quot; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: crePred2])<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Не заполнена дата или она меньше 01.01.2019<br />//Дата больше date0Cre2 но меньше date1Cre2<br />//Дата больше date1Cre3 и меньше date1Cre4<br />//Дата больше date1Cre4 и меньше dateCreEnd<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CommitContext </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">ctx = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CommitContext</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Добавляем к уже существующему представлению дополнительное свойство isLiving<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">View </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">viewCre = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getViewCre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Список отработанных контрагентов для вывода в лог, если нужно<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; contragentsLoging = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ArrayList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Если нужно убрать признак принятия допа<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; suppContracts = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ArrayList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">mainContract;<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">long </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">stP = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">System</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">currentTimeMillis</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//363<br />//for(i=10; i&lt;=13; i++){<br />//    System.out.println(&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Counter script = &quot;+i.toString())<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">long </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">stQ = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">System</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">currentTimeMillis</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Отобрать которые не заходили<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; contragents = dataManager.load(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//        .query('select distinct e from rtneo$ContragentRealEstate r join rtneo$Contragent e where r.contragent = e and (r.category.isLiving is null or r.category.isLiving=false) and not r.realEstate.name = \'Земельный участок\' and size(e.contracts)=0 and not e.id in (select t.entityId from rtneo$EntityesTemporarySet t) order by e.id')<br />//        .query('select distinct e from rtneo$ContragentRealEstate r join rtneo$Contragent e on r.contragent = e where ((r.category.isLiving is null or r.category.isLiving=false) and not r.realEstate.name = \'Земельный участок\' and size(e.contracts)=0 and (r.validityFrom is null or r.validityFrom &gt;= \'2019-01-01\') and not r.excludeFromAccounting = true) or (e.id in (select t.entityId from rtneo$EntityesTemporarySet t where not t.setName = \'CreatedContractAllRecalc30-09\')) order by e.id EXCEPT select distinct e from rtneo$Contragent e join rtneo$EntityesTemporarySet t where e.id = t.entityId and t.setName = \'CreatedContractAllRecalc30-09\'')<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.query(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select c from rtneo$Contragent c where c.id = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">251d2e41-b732-915c-138d-b5b09ff88ec3</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//        .query('select distinct e from rtneo$ContragentRealEstate r join rtneo$Contragent e on r.contragent = e where (((r.category.isLiving is null or r.category.isLiving=false) and not r.realEstate.name = \'Земельный участок\' and size(e.contracts)=0 and (r.validityFrom is null or r.validityFrom &gt;= \'2019-01-01\') and not r.excludeFromAccounting = true) or (e.id in (select t.entityId from rtneo$EntityesTemporarySet t where not t.setName = \'CreatedContractAllRecalc30-09\'))) and not e.id in (select t.entityId from rtneo$EntityesTemporarySet t where t.setName = \'CreatedContractAllRecalc30-09\')')<br />//        .query('select distinct c from rtneo$Contragent c join rtneo$EntityesTemporarySet t on c.id = t.entityId where t.setName = \'oneIsLogin04-10-20CreatedContract\' order by c.id')<br />//        .query('select distinct c from rtneo$Contragent c join rtneo$EntityesTemporarySet t on c.id = t.entityId where size(c.contracts) = 1 and t.setName = \'oneIsNoLogin04-10-20CreatedContract\' order by c.id')<br />//        .query('select distinct c from rtneo$Contragent c join rtneo$EntityesTemporarySet t on c.id = t.entityId where t.setName = \'AllContragentCreateContract_15-10-20\' order by c.id')<br />//            .query('select c from rtneo$Contragent c join rtneo$EntityesTemporarySet t on c.id = t.entityId where t.setName = \'AllContragentCreateContract_15-10-20\'  and not c.id in (select t.entityId from rtneo$EntityesTemporarySet t where t.setName = \'AllContragentCreateContract_15-10-20-OK\' or t.setName = \'AllContragentCreateContract_15-10-20-Failed\') order by c.id')<br />//            .firstResult(i*100)<br />//            .maxResults(100)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.view(viewCre)<br />        .list()<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">long </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">endQ = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">System</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">currentTimeMillis</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;Perfomance </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">endQ-stQ</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br /><br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: contragents){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toString</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()+</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">' - '</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getName</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Паттерн стратегия<br />//        if(onlyOffer) mainContract = getMainContract(contragent)<br />    //Отрефакторить<br />//        HashMap&lt;String, List&gt; mapCreList = onlyOffer ? ['cre1' : getCREFromMainContract(mainContract, viewCre)] : getCREList(contragent, start, dateCre1)<br /><br />    //Получаем список объектов<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SelCREStrategy </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">creList = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CreList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, includedPeriod)<br />    creList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setLog</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(log)<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; mapCreList = creList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />    mapCreList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">keySet</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">each</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;CreList &gt;&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">mapCreList</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Создаем договор и доп<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">isCreated = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />    if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(mapCreList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">isEmpty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">continue<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Удалять старые договора!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(cleanOffer)</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">cleanOfferContracts</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; paramsContract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br />    paramsContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragent&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    paramsContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;start&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, start)<br />    paramsContract.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;end&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, end)<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">key </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: mapCreList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">keySet</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CollectionUtils</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">isEmpty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(mapCreList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">key</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)))</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">continue<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//            isCreated = createContract(mapCreList.get(key), paramsContract, contragentsLoging)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CreateContractStrategy </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">created = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CreateContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />        created.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setLog</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(log)<br />        isCreated = created.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">createContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(mapCreList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">key</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">), paramsContract, contragentsLoging)<br />    }<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(isCreated){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; paramsSet = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br />        paramsSet.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;entityName&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;Contragent&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        paramsSet.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;setName&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;AllContragentCreateContract_15-10-20&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        paramsSet.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">put</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;comment&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;Создание договоров всем&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//            addInTemporarySet(contragent, paramsSet, onlyOffer)<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /><br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//}//FOR<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">long </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">endP = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">System</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">currentTimeMillis</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;Perfomance </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">endP-stP</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Убираем признак принятия допа<br />//unaccepted(suppContracts)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;*****************************************************************************&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Список обработанных контрагентов<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">contragentsLoging.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">each</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">/**<br /> * <br /> */<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">interface </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SelCREStrategy</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CreList </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">implements </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SelCREStrategy</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">LinkedHashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt;&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">predications</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DataManager </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">dataManager </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DataManager</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">GroovyConsoleLogger </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /><br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">CreList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">LinkedHashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt;&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">predications</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">this</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contragent </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">this</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">predications </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">predications<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#e5c07b;">@Override<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() {<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; mapCreList = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;&gt;()<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Берем только не покрытые объекты<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentRealEstate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; cres = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">dataManager</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">load</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentRealEstate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">query</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select c from rtneo$ContragentRealEstate c where (select count(cp) from rtneo$ContractPosition cp where cp.contragentRealEstate.id = c.id) = 0 and c.contragent.id = :contragent_id and not c.realEstate.name = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">Земельный участок</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;"> and not c.excludeFromAccounting = true and (c.category.isLiving is null or c.category.isLiving=false)'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parameter</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragent_id&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">view</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getViewCre1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">list</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Распределяем объекты по группам//contragent.getRealEstates()<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentRealEstate </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: cres){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">isFind = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />            if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">checkCRE</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">continue<br /><br />            for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">predications</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">entrySet</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()){<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">MyPredicate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentRealEstate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; pred = (</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">MyPredicate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentRealEstate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt;)</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;pred&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">from = (</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;from&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">to = (</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getValue</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;to&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(pred.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">test</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(from, to, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />                    mapCreList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">putIfAbsent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getKey</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(), </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ArrayList</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentRealEstate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt;())<br />                    mapCreList.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">item</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getKey</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">add</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                    isFind = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />                    break<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />            }<br /><br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(!isFind)</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">debug</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;No set CRE </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        }<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">mapCreList<br />    }<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">View </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getViewCre1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ViewRepository </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">vRep = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ViewRepository</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//    return vRep.getView(Contragent.class, &quot;contragent-create-contract&quot;)<br />        //    .addProperty(&quot;realEstates&quot;,<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">vRep.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragent-create-contract&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;realEstates&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;exportStartDate&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;type&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, vRep.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">RealEstateType</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_minimal&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                        .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;isLiving&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                )<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//    )<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">private boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">checkCRE</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentRealEstate </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">df = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;dd.MM.yyyy&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">start = df.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'01.01.2019'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">isSkip = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br />        if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getCategory</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() == </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">debug</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;CRE </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;"> not category!&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            isSkip = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Исключаем жилые<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getType</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() != </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&amp;&amp; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">TRUE</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getType</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getIsLiving</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">debug</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;CRE </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;"> is living!&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            isSkip = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Исключаем исключенные из учета<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">TRUE</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getExcludeFromAccounting</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">debug</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;CRE </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;"> is exclude!&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            isSkip = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//Исключаем земельные уастки<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getRealEstate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getName</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() != </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&amp;&amp; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getRealEstate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getName</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'Земельный участок'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">debug</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;CRE </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;"> is land plot!&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            isSkip = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getExportStartDate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() != </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&amp;&amp; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getExportStartDate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">compareTo</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(start) &gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">debug</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;CRE </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;"> start export!&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            isSkip = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CollectionUtils</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">isEmpty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getContainerYards</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())) {<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">debug</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;Contragent &gt;&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getContragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;"> ContainerYards empty&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            isSkip = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getRealEstate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getArea</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() == </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">debug</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;CRE </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;"> area is null&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            isSkip = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//            if(!Boolean.TRUE.equals(cre.getCategory().getUnit().getIsArea()) &amp;&amp; (cre.getCalculationAmount() == null || cre.getCalculationAmount() != (int)cre.getCalculationAmount())){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">TRUE</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getCategory</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getUnit</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getIsArea</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">debug</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;CRE </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;"> no set calculationAmount&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//                def calculationAmount = new BigDecimal(cre.getRealEstate().getArea()*cre.getCategory().getRatio()).setScale(0, RoundingMode.HALF_UP)<br />//                if (calculationAmount.compareTo(BigDecimal.ZERO) == 0) {<br />//                    calculationAmount = BigDecimal.ONE;<br />//                }<br />//                cre.setCalculationAmount(calculationAmount)<br />//                dataManager.commit(cre)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">isSkip<br />    }<br />}<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">abstract class </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CreateContractAbstract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContractService </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contractService </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContractService</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CalculationWorker </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">calculationWorker </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CalculationWorker</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DataManager </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">dataManager </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DataManager</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">GroovyConsoleLogger </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">create</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">try</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">this</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">create</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">debug</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;Contract good &gt;&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        }</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">catch</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Exception </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">debug</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;Contract fail &gt;&gt;: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contract<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contract<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">abstract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">create</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">void </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">processContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accepted</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">confirm</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">acceptanceDate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CalculationWorker </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">calculationWorker = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CalculationWorker</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">TransactionalDataManager </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">txManager = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">TransactionalDataManager</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//получаем предыдущий договор<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">lastContract = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getMainContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() != </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; contracts = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">dataManager</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">load</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                    .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">query</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select c from rtneo$Contract c where (c.mainContract.id=:mainContract OR c.id=:mainContract) ' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+<br />                            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'AND NOT c.id=:id ' </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">+<br />                            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'order by c.createTs DESC'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                    .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parameter</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;mainContract&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getMainContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">().</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />                    .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parameter</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;id&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />                    .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">view</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contract-edit&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                    .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">maxResults</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                    .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">list</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contracts.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() &gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />                lastContract = contracts.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />            }<br />        }<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accepted</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br /><br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//делаем предыдущий неактивным<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(lastContract != </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">makeContractObsolete</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(lastContract, </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />            }<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//текущий делаем активным<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">makeContractObsolete</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//коммит<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setAccepted</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">accepted</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setAcceptanceDate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">acceptanceDate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">dataManager</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">commit</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        } </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(!</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">confirm</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">dataManager</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">remove</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />    }<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">private void </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">makeContractObsolete</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">reverse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">) {<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">dataManager</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">reload</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contract-edit&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CommitContext </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">commitContext = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CommitContext</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContractPosition </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">position </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getPositions</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()) {<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">position</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setRelevance</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">reverse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />            commitContext.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addInstanceToCommit</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">position</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />        }<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">dataManager</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">commit</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(commitContext);<br />    }<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContractForCRE </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">extends </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CreateContractAbstract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">create</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Preconditions</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">checkNotNullArgument</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">cres</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contractService</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">createNewBaseContractClean</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">contragent </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">as </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">start </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">as </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">end </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">as </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//    contractService.fillBaseContract(contragent, contract, start, end)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contractService</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">fillBaseContractR</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">contragent </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">as </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">cres </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">as </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentRealEstate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt;);<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contract<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SuppContractForCRE </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">extends </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CreateContractAbstract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">df </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;dd.MM.yyyy&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">create</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Preconditions</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">checkNotNullArgument</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">cres</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Preconditions</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">checkNotNullArgument</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">baseContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">baseContract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">dataManager</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">reload</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">baseContract </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">as </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Entity</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contract-view-createSupplementaryAggrements&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contractService</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">createNewSuppContractClean</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">contragent </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">as </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">baseContract </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">as </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">start </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">as </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">end </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">as </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contractService</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">buildContractPositionsForRealEstateSupp</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">contragent </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">as </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">start </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">as </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">cres </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">as </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentRealEstate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt;);<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">UnaryOperator</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; consumer = </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">-&gt;<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.setTemplate(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;MSG310820&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.setDate(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">df</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;30.06.2019&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">processContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(consumer.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">apply</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">), </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">acceptanceDate </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">as </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Accrual</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; accruals = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">calculationWorker</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">calculateAccruals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getFrom</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(), </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">df</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">parse</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;31.12.2020&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">), </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">contragent </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">as </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Date</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(), </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">contract<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />}<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">interface </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CreateContractStrategy</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CreateContract </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">implements </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CreateContractStrategy</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DataManager </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">dataManager </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DataManager</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">GroovyConsoleLogger </span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">CreateContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">GroovyConsoleLogger </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">this</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">= </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">log<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#e5c07b;">@Override<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() {<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return null<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">createContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentRealEstate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cres</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragentsLoging</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Preconditions</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">checkNotNullArgument</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Preconditions</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">checkNotNullArgument</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">start</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Preconditions</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">checkNotNullArgument</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">end</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">putIfAbsent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;cres&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">cres</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">contract;<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">suppContract;<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">isCreated = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContractForCRE </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">contractForCRE = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContractForCRE</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br />        contractForCRE.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setParams</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        contractForCRE.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setLog</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        contract = contractForCRE.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">create</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">PersistenceHelper</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">isNew</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contract))</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">dataManager</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">commit</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(contract)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">putIfAbsent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;baseContract&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, contract)<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SuppContractForCRE </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">suppContractForCRE = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SuppContractForCRE</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">();<br />        suppContractForCRE.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setParams</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        suppContractForCRE.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setLog</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#ffa7a7;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        suppContract = suppContractForCRE.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">create</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">//        suppContract = createSuppContractForCRE(params.contragent, onlyOffer ? params.mainContract : contract, params.start, params.end, cres)<br /><br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(suppContract != </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragentsLoging</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">add</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">|</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.getName()</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            isCreated = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">true<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">isCreated<br />    }<br />}<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">/**<br /> * <br /> *<br /> */<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">public </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getMainContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">mainContract = dataManager.load(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .query(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select c from rtneo$Contract c where c.mainContract is null and c.contragent.id = :contragent'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragent&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />            .view(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_local&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .firstResult(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .maxResults(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .optional().orElse(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Preconditions</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">checkNotNullArgument</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(mainContract)<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">mainContract;<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">public void </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">cleanContracts</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; contracts = dataManager.load(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .query(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select c from rtneo$Contract c where c.contragent.id = :contragent'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragent&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />            .view(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_minimal&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .list()<br />    contracts.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">each</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">dataManager.remove(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">public void </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">cleanContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    dataManager.remove(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">public void </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">cleanOfferContracts</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; contracts = dataManager.load(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .query(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select c from rtneo$Contract c where c.contragent.id = :contragent and c.template = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">MSG310820</span><span style=" font-family:'JetBrains Mono,monospace'; color:#2bbac5;">\'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragent&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />            .view(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_minimal&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .list()<br />    contracts.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">each</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">dataManager.remove(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">public void </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">unaccepted</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contracts</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CommitContext </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">ctx = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">CommitContext</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contracts</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setAccepted</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">false</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setAcceptanceDate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />        ctx.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addInstanceToCommit</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    }<br /><br />    dataManager.commit(ctx)<br />}<br /><br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">void </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addInTemporarySet</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">HashMap</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Boolean </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">onlyOffer</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Preconditions</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">checkNotNullArgument</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;entityName&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Preconditions</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">checkNotNullArgument</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;setName&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Preconditions</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">checkNotNullArgument</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;comment&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br /><br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">EntityesTemporarySet </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">tempSet = dataManager.create(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">EntityesTemporarySet</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    tempSet.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setEntityId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />    tempSet.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setEntityName</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;entityName&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />    tempSet.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setSetVersion</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">1</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(isCreated){<br />        tempSet.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setSetName</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;setName&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toString</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()+</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;-OK&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        tempSet.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setSetComment</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;comment&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />    }</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">else</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{<br />        tempSet.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setSetName</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;setName&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toString</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()+</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;-Failed&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        tempSet.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">setSetComment</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">params</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;comment&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(cleanFailed)</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">cleanContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">$</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">contragent</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;"> cleans contract&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    }<br />    dataManager.commit(tempSet)<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">View </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getViewCre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ViewRepository </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">vRep = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ViewRepository</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">vRep.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragent-create-contract&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;realEstates&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, vRep.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contragent</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contragent-create-contract&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                    .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;realEstates&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">()<br />                    .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;exportStartDate&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                    .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;type&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, vRep.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">RealEstateType</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;_minimal&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                            .</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">addProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;isLiving&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />                    )<br />            )<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">List</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&lt;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentRealEstate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">&gt; </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getCREFromMainContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Contract </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">mainContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">View </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">viewCre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">dataManager.load(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">ContragentRealEstate</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">class</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .query(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">'select c.contragentRealEstate from rtneo$ContractPosition c where c.contract.id = :contract and c.contragentRealEstate is not null'</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            .parameter(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;contract&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">mainContract</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getId</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />            .view(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">viewCre</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getProperty</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;realEstates&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">).</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">getView</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">())<br />            .list()<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#5c6370;">/**<br /> * Логирование<br /> */<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.haulmont.cuba.core.app.serialization.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">EntitySerializationAPI</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">com.groupstp.rtneo.util.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">JsonUtil</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.text.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">import </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">java.text.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">;<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">private </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">, </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">String</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">... </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">options</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">== </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">null</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;LOG.ERROR: Object is null!!!&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">return</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">}<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">options</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">size</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">() == </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">0</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br />    </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">for</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">def </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">option </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">: </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">options</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">option</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;str&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">option</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;for&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">each</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">_</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">it</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)</span><span style=" font-family:'JetBrains Mono,monospace'; font-weight:600; color:#bbbbbb;">}</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">option</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;json&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">EntitySerializationAPI </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">entitySerializationAPI = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">EntitySerializationAPI</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">try</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(entitySerializationAPI.toJson(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))}<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">catch</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Exception </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;LOG.ERROR: JSON entity serialization failed&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br />        }<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">option</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;objJson&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">JsonUtil </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">jsonUtil = </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">AppBeans</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">get</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">JsonUtil</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">NAME</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">try</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{log.(jsonUtil.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">toJson</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))}<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">catch</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Exception </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;LOG.ERROR: JSON object serialization failed&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br />        }<br />        </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">if</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">option</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">equals</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;date&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)){<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">DateFormat </span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">df = </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">new </span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">SimpleDateFormat</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;dd.MM.yyyy&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">);<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">try</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">{</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(df.</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">format</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">))}<br />            </span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">catch</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Exception </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">e</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){</span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#89ca78;">&quot;LOG.ERROR: Failed date format&quot;</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}<br />        }<br />    }<br />}<br /></span><span style=" font-family:'JetBrains Mono,monospace'; font-style:italic; color:#d55fde;">private </span><span style=" font-family:'JetBrains Mono,monospace'; color:#61afef;">log</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#e5c07b;">Object </span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">){log.debug(</span><span style=" font-family:'JetBrains Mono,monospace'; color:#d19a66;">obj</span><span style=" font-family:'JetBrains Mono,monospace'; color:#bbbbbb;">)}</span></p></body></html>